select o.o_orderpriority,
count(o.o_orderkey) as order_count
from orders o
where
o.o_orderdate >= '1993-03-01'
and o.o_orderdate < '1993-06-01'
and exists
(
select l.l_orderkey
from lineitem l
where l.l_orderkey = o.o_orderkey
and l.l_commitdate < l.l_receiptdate
)
group by o.o_orderpriority
order by o.o_orderpriority
